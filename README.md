# Polina
Перед началом установки, нужно установить Linux Oracle в VirtualBox, для этого нужного:
Иметь образ Linux 5096+ МБ оперативы.
_______________________________________________________________________________________
Далее переходим к установке docker с использованием grafana, вводим следующий набор команд:
1. ```sudo yu install wget```
- ***устанавливает утилиту wget на нашу систему***
![VirtualBox_Petrunina_14_02_2025_19_49_40](https://github.com/user-attachments/assets/c7a826ad-32cc-4d20-9238-37a06894471d)
- После выполнения этой команды система запросит подтверждение на установку и загрузит необходимые файлы, после чего утилита wget будет доступна для использования.

______________________________________________________________________________________
2. ```sudo wget -P /etc/yum.repos.d/ https://download.docker.com/linux/centos/docker-ce.repo```
- ***Команда используется для загрузки файла репозитория Docker для CentOS и сохранения его в определенном каталоге.***
![3](https://github.com/user-attachments/assets/1c78dcec-3186-42b5-9fcf-b7be03fd0f80)
- команда загружает файл docker-ce.repo с указанного URL и сохраняет его в директории /etc/yum.repos.d/. Файл репозитория необходим для настройки пакетного менеджера yum, чтобы он мог находить и устанавливать пакеты Docker.

______________________________________________________________________________________  
3. ```sudo yum install docker-ce docker-ce-cli containerd.io```
- ***Эта команда устанавливает три ключевых компонента Docker на систему:***

     • ***Docker Community Edition (docker-ce)***: основной пакет, необходимый для работы с контейнерами.

     • ***CLI (docker-ce-cli)***: инструмент командной строки для взаимодействия с Docker.

     • ***Containerd (containerd.io)***: служба для управления контейнерами на уровне операционной системы.
![4](https://github.com/user-attachments/assets/941c0529-6d2e-4440-85cc-aaef436ea277)

______________________________________________________________________________________
4. ```sudo systemctl enable docker --now```
- Эта команда включает службу Docker и настраивает её на автоматический запуск при старте системы. Это важно для обеспечения работы контейнеров без необходимости вручную запускать службу после каждой перезагрузки.

______________________________________________________________________________________
5. ```sudo yum install curl```
Эта команда устанавливает пакет curl на вашу систему. Наличие curl может быть полезным для проверки доступности веб-ресурсов, загрузки файлов и выполнения различных сетевых запросов. Например, можем использовать curl для проверки состояния вашего веб-сервера или ***API***.

______________________________________________________________________________________
6. ```COMVER=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d\" -f4)```
- После выполнения этой команды, если текущая последняя версия Docker Compose — 1.29.2, то переменная COMVER будет содержать значение 1.29.2. Это значение можно использовать в последующих командах, например, для установки или обновления Docker Compose.
- ***Эта команда выполняет следующие действия***:
1. Отправляет запрос к GitHub API для получения информации о последнем релизе Docker Compose.
2. Извлекает строку, содержащую название тега (версию) из JSON-ответа.
3. Извлекает сам номер версии из этой строки.
4. Сохраняет полученное значение в переменной COMVER.

______________________________________________________________________________________  
7. ```sudo curl -L "https://github.com/docker/compose/releases/download/$COMVER/docker-compose-$(uname -s)-$(uname -m)" -o /usr/bin/docker-compose```
- Теперь скачиваем скрипт docker-compose последней версии, используя объявленную ранее переменную и помещаем его в каталог ```/usr/bin```
- ***Эта команда выполняет следующие действия***:
1. С помощью curl она загружает исполняемый файл Docker Compose последней версии с GitHub.
2. Используя переменные $COMVER, $(uname -s) и $(uname -m), она формирует правильный URL для загрузки файла, соответствующего вашей операционной системе и архитектуре.
3. Сохраняет загруженный файл в каталоге /usr/bin под именем docker-compose.
![6](https://github.com/user-attachments/assets/ff39d03e-9ad7-4bca-b1d6-289e0764e034)

______________________________________________________________________________________
8. ```sudo chmod +x /usr/bin/docker-compose```
- После выполнения этой команды файл docker-compose получит право на выполнение, что позволит  запускать его из командной строки. Без этого шага не сможем использовать команду docker-compose, так как операционная система не распознает файл как исполняемый.

______________________________________________________________________________________  
9. ```docker-compose --version```
- После выполнения этой команды в терминале вы получите вывод, содержащий номер версии установленного Docker Compose
![9](https://github.com/user-attachments/assets/259acd80-6ea0-4ce1-8f29-8912fe494710)
- Можно скачать git прямо из командной строки прописав Y

 ______________________________________________________________________________________ 
10.
    ![10](https://github.com/user-attachments/assets/884bbe0d-a21b-47ca-b0ba-6a4d4b94ffb3)
  - Как заметим, произошла ошибка; ```Не удалось установить пакеты: Failed  to obtain authentication```
![Fail](https://github.com/user-attachments/assets/5e3b4dfb-61ac-43ed-8042-6a6e5826e264)
        Что бы избавиться от проблемы, было принято ввести команду с использованием sudo, права суперпользователя. Это нужно, если мы хотим установить или изменить что-то в системе: ```sudo git clone https://github.com/skl256/grafana_stack_for_docker.git```
```sudo yum install git``` - команда, которая установила Git на систему.
![Problem](https://github.com/user-attachments/assets/0b0f9b74-2f52-464a-bec3-6f2b7605e1e9)
     ***Ошибка была исправлена, Git был установлен.***
![+](https://github.com/user-attachments/assets/72c9be2d-0aa0-4bde-bd87-ccebb87bf70a)

______________________________________________________________________________________
11. ```cd grafana_stack_for_docker```
    - Когда выполняется команда cd grafana_stack_for_docker, мы переходим в каталог grafana_stack_for_docker. Это значит, что все последующие команды, которые мы будем вводить в терминале, будут выполняться относительно этого каталога. Это удобно, так как мы можем работать с файлами и настройками, находящимися в этой папке, без необходимости указывать полный путь к ним.

______________________________________________________________________________________
12. ```sudo mkdir -p /mnt/common_volume/grafana```
    - После выполнения этой команды будет создан каталог /mnt/common_volume/grafana, включая все необходимые промежуточные каталоги. Это позволяет организовать структуру папок на вашем сервере или локальной машине для хранения данных Grafana, которые могут быть использованы для хранения конфигурационных файлов, логов или других данных. Создание такой структуры заранее помогает избежать проблем с отсутствующими директориями при запуске приложений и сервисов.
   
______________________________________________________________________________________      
13. ```sudo mkdir -p /mnt/common_volume/swarm/grafana/config```
![Снимок](https://github.com/user-attachments/assets/85eb0b76-c4e3-4f97-b262-c9b58b80f967)
    - команда создает структуру каталогов для Grafana и связанных с ней компонентов, если они ещё не существуют

______________________________________________________________________________________      
14. ```sudo chown -R $(id -u):$(id -g) {/mnt/common_volume/swarm/grafana/config,/mnt/common_volume/grafana}```
    - все файлы и каталоги в указанных директориях будут переделаны в собственность  текущему пользователю и его группе
![12](https://github.com/user-attachments/assets/440ad579-f46b-46e3-a552-4fd74adc645f)

______________________________________________________________________________________
15. ```touch /mnt/common_volume/grafana/grafana-config/grafana.ini```
    - файл уже существует. Команда обновит его временые метки.

______________________________________________________________________________________      
16. ```cp config/* /mnt/common_volume/swarm/grafana/config/```
    - команда копирует все файлы и подкаталоги из директории config в директорию ```/mnt/common_volume/swarm/grafana/config/```

______________________________________________________________________________________      
17. ```sudo mv grafana.yaml docker-compose.yaml```
    
![18](https://github.com/user-attachments/assets/421e9d3b-6780-42c1-9308-9c2f1b04af30)
    - команда переименовывает файл -grafana.yaml в docker

______________________________________________________________________________________      
18. ```sudo docker compose up -d```

![image](https://github.com/user-attachments/assets/80745329-dbf0-448f-ae17-f34942366d6c)

    - команда создает и запускает контейнеры в фоновом режиме, используя конфигурация из файлов docker-compromise.yml с правами суперпользователя.
    
![stop](https://github.com/user-attachments/assets/4be56df0-e4f4-4bc7-a551-d1ad0bb1fdcc)

______________________________________________________________________________________
19. ```sudo vi docker.compromise.yaml```
    - эта команда предназначена для редактирования конфигурационного файла docker.compromise.yaml с правами суперпользователя.
      
![1](https://github.com/user-attachments/assets/93e53952-f3c1-49ee-91a7-724187735fe0)
![2](https://github.com/user-attachments/assets/3fdcddba-e665-499f-b51a-73bcfeb36cdd)

______________________________________________________________________________________
20. ```sudo docker ps```
    -  эта команда позволяет увидеть текущие активные контейнеры в системе.
      
![-а](https://github.com/user-attachments/assets/92a10830-259b-44c7-8d0c-fd1ab7617708)

______________________________________________________________________________________
21. ```sudo docker compose stop```
   - Останавливает все запущенные контейнеры, определённые в файле docker-compose.yml, но не удаляет их
![Без названия401_20250320123235](https://github.com/user-attachments/assets/521256b7-04bb-40f0-9a8e-4e8f229d3200)


______________________________________________________________________________________
23. ```sudo docker compose down```
![4](https://github.com/user-attachments/assets/1b43d1ea-785e-48ea-baac-182eb8f10068)

______________________________________________________________________________________
24. ```sudo docker compose ps```
    
   - При выполнении этой команды выводится список всех контейнеров с их текущим состоянием (запущен или остановлен), а также дополнительная информация, такая как используемые порты, подключенные сети и другие параметры конфигурации. Это позволяет быстро оценить, какие контейнеры активны, а какие нет, а также получить представление о сетевой инфраструктуре и взаимодействиях между контейнерами.

![Без названия409_20250328151804](https://github.com/user-attachments/assets/1fd8c5a6-9377-4c5a-9ff0-74d26c617d79)

________________________________________________________________________________________
25. ```git clone https://github.com/sksi1217/Polina.git```

    ![-2147483648_-212086](https://github.com/user-attachments/assets/723725c4-2c4d-400a-bdc3-b93ea13cf4ad)

- Командой выполняем клонирование удаленного Git-репозитория с GitHub в папку
________________________________________________________________________________________
26. ```pwd```

    - **pwd** — это команда в Unix-подобных операционных системах (таких как Linux и macOS), которая выводит текущую рабочую директорию (путь к ней). Расшифровывается как "print working directory". Когда вы вводите pwd в терминале, система отображает полный путь к каталогу, в котором вы находитесь в данный момент.

![Без названия410_20250328153714](https://github.com/user-attachments/assets/d573a3cd-fe9e-43c2-9b8e-4507576779df)
    

27. ```mv Polina/prometeus.yaml ./```
```mv Polina/docker-compose.yaml ./ ```

- Перемещаем файлы в корневую директорию grafanastackfor_docker, но прежде необходимо создать резервную копию предыдущего файла docker-compose.yaml.

Резервная копия — это сохраненная копия важных данных, которая хранится отдельно и может быть использована для их восстановления в случае необходимости.

_____________________________________________________________________________________________
28. ```sudo mv prometeus.yaml /mnt/common_volume/swarm/grafana/config/```

Нужно переименовать файл правильным названием в prometheus.yaml, но перед этим нужно сделать Бэкап придыдущего файла prometheus.yaml

![Без названия411_20250328160033](https://github.com/user-attachments/assets/d77c9c13-cd2e-45fe-ac51-fa3ff2c61b19)
___________________________________________________________________________________
**Я запустила контейнеры Docker с помощью команды, чтобы получить доступ к интерфейсу через браузер.**

```sudo docker compose up -d```

Для доступа к интерфейсу открыла:

```localhost:3000```
Логин и пароль: **admin / admin.**

После входа необходимо создать дашборды. Для этого перейдите по следующему пути: Home -> Connections -> Data sources -> Add data source.

Затем нажмите на +Add visualization -> Configure a new data source -> Prometheus.

**- Настройки должны быть следующими:**
   • Authentication: Basic authentication
   • Connection: http://prometheus:9090

После завершения настройки нажала **Save  test**.

Создав дашборд, его можно импортировать. Для этого перейдем по пути: Home -> Dashboards -> Import dashboard.

В поле вводим 1860 и нажимаем Load. Выбрала Prometheus, затем нажала Import и задашла название для своего дашборда.

![425718976-2417d6da-f281-4157-b092-45cf443d5184](https://github.com/user-attachments/assets/61172f5b-07fa-445d-9281-6e47fd4d25f9)

![425718984-c9d745b8-eea0-4d0d-9562-951532eb22de](https://github.com/user-attachments/assets/a88a0e62-b65b-4407-b56f-172892b56f82)

______________________________________________________________________________________________

29. ![425727341-98587646-38e4-42e0-abde-839e4160c8ed](https://github.com/user-attachments/assets/847d50d1-12fd-4852-99a7-d7049484396a)

![425727545-d1a19ad1-1a61-4b97-9e34-767474ffedbf](https://github.com/user-attachments/assets/91d35e4c-9d5f-41b5-82ec-d35949005418)


![-2147483648_-212088](https://github.com/user-attachments/assets/5139cd9f-6664-4a8f-8941-5d3effc40c45)
